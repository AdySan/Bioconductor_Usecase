---
title: "GC content"
author: "Sharonhe"
date: "November 5, 2016"
output: html_document
---

# Dependencies
library(AnnotationHub)
library(BSgenome)

# Project 1: compute the GC content of promoters in the yeast genome. 

## Get yeast genome
```{r}
library("BSgenome.Scerevisiae.UCSC.sacCer2")
Scerevisiae
```


## Get promoter ranges of yeast genome

```{r}
ahub = AnnotationHub()
qh = query(ahub, c("sacCer2", "genes"))
qh
genes = ahub[["AH7048"]]
prom = promoters(genes)
# There is warning messages here because G ranges complain when it gets like genome indices that are less than zero. This problem can be solved by trimming promoters
prom = trim(prom)
prom
```

## View the promoter

```{r}
promViews = Views(Scerevisiae, prom)
```


## Get GC content in the promoter and make a density plot

```{r}
gcProm = letterFrequency(promViews, "GC", as.prob = TRUE)
plot(density(gcProm))
abline(v = 0.38)
```

# Project 2: Compute the GC content of “chr22” in the “hg19” build of the human genome

## Get hg19 human genome

```{r}
source("https://bioconductor.org/biocLite.R")
biocLite("BSgenome.Hsapiens.UCSC.hg19")
library(BSgenome.Hsapiens.UCSC.hg19)
Hsapiens
```

# count total bases on chr22

```{r}
totalBase <- letterFrequency(Hsapiens$chr22, "A") +
             letterFrequency(Hsapiens$chr22, "C") +
             letterFrequency(Hsapiens$chr22, "G") +
             letterFrequency(Hsapiens$chr22, "T")
```

# count GC bases on chr22  

```{r}
gcBase <- letterFrequency(Hsapiens$chr22, "GC")
```

# calculate GC ratio on chr22

```{r}
gcContent <- gcBase/totalBase
gcContent
```

# Project 3: Compute the mean GC content of H3K27me3 “narrowPeak” regions from Epigenomics Roadmap from the H1 stem cell line on chr 22.

## getting data of H3K27me3 “narrowPeak” regions from Epigenomics Roadmap

```{r}
ah <- AnnotationHub()
H3K27me3_qh <- query(ah, c("H3K27me3", "E003", "narrowPeak"))
H3K27me3_qh
H3K27me3_data <- H3K27me3_qh[["AH29892"]] # retrieve data
```

## get genomic ranges on chr22 from the above epigenetic data 

```{r}
H3K27me3_data.chr22 <- subset(H3K27me3_data, seqnames == "chr22")
```

## get the corresponding DNA sequence

```{r}
library(BSgenome.Hsapiens.UCSC.hg19)
Hsapiens
H3K27me3_data.chr22.seq <- Views(Hsapiens, H3K27me3_data.chr22)
```

# calculate GC content on chr22

```{r}
gcContents <- letterFrequency(H3K27me3_data.chr22.seq, "GC", as.prob = T)
meanGcContents <- mean(gcContents)
meanGcContents
```



sessioninfor()
